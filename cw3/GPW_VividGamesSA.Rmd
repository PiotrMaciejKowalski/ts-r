---
title: "GPW-Vivid Games SA"
author: "Joanna SzymaÅ„ska"
date: "16 marca 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Wczytywanie danych

PoniÅ¼szy plik przedstawia dane dotyczÄ…ce notowaÅ„ spÃ³Å‚ki Vivid Games SA w okresie 16.03.2018.-16.03.2019.

## O spÃ³Å‚ce

Vivid Games SA to nowoczesne studio deweloperskie zajmujÄ…ce siÄ™ projektowaniem, produkcjÄ… oraz publikowaniem gier na konsole przenoÅ›ne i stacjonarne, komputery klasy PC i Mac, oraz nowoczesne telefony komÃ³rkowe (smartfony) â€“ ktÃ³re stanowiÄ… najbardziej dynamicznie rozwijajÄ…cy siÄ™ sektor rynku.

```{r dane}
dgpw1 <- read.csv("GPW-VividGamesSA-dane.csv", col.names =c("Data","Otwarcie","Zamkniecie","Max","Min","Obrot_mln_zl","Zmiana_proc."))
head(dgpw1)
```
```{r}
dgpw<-dgpw1[,2:5]
head(dgpw)
```

PoniÅ¼ej widoczne jest krÃ³tkie podsumowanie dla kaÅ¼ej z czterech badanych wartoÅ›ci - w tym najmniejsza i najwiÄ™ksza osiÄ…gniÄ™ta wartoÅ›Ä‡ oraz Å›rednia i mediana.
```{r}
summary(dgpw)
```



```{r pressure, echo=FALSE}
x=250:1
  
wykres_otw=plot(x,dgpw$Otwarcie, type ="l", main="Otwarcie", xlab="Dni robocze od 16.03.2018", ylab="WartoÅ›Ä‡ w mln zÅ‚")
plot(x,dgpw$Zamkniecie, type ="l",   main="Zamkniecie", xlab="Dni robocze od 16.03.2018", ylab="WartoÅ›Ä‡ w mln zÅ‚", col="blue")
```


Dla uÅ‚atwienia porÃ³wnania zobaczmy dane na jednym wykresie:

```{r}
plot(x,dgpw$Otwarcie, type ="l", main="Otwarcie i zamkniÄ™cie", xlab="Dni robocze od 16.03.2018", ylab="WartoÅ›Ä‡ w mln zÅ‚")
lines(x,dgpw$Zamkniecie, type ="l",  col="blue")
```

```{r}
i=1
otw=dgpw$Otwarcie
zam=dgpw$Zamkniecie
zmiana=rep(0,250)
for(i in 1:250){
  zmiana[i]=otw[i]-zam[i]
}
plot(x,zmiana, type="l", main="Zmiana wartosci pomiedzy otwarciem i zamknieciem", xlab="Dni robocze od 16.03.2018", ylab="WartoÅ›Ä‡", col="purple")
```






Teraz przyjrzymy siÄ™ maksymalnym i minimalnym wartoÅ›ciom w kolejnych dniach roboczych.
```{r}
plot(x,dgpw$Max, type ="l", main="Maksimum i minimum ", xlab="Dni robocze od 16.03.2018", ylab="WartoÅ›Ä‡ w mln zÅ‚", col="green")
lines(x,dgpw$Min, type ="l",  col="red")
```


SprawdÅºmy czÄ™stotliwoÅ›Ä‡ osiÄ…gania wartoÅ›ci z okreÅ›lonych przedziaÅ‚Ã³w dla maksimum i minimum.




```{r}
hist(dgpw$Max, main="Histogram maksimum", xlab="WartoÅ›Ä‡", ylab="CzÄ™stotliwoÅ›Ä‡", col="green", breaks=c(0,0.5,1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7) )
hist(dgpw$Min, main="Histogram minimum", xlab="WartoÅ›Ä‡", ylab="CzÄ™stotliwoÅ›Ä‡", col="red", breaks=c(0,0.5,1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7) )
```



Policzmy rÃ³Å¼nice pomiedzy najwiÄ™kszÄ… a najmniejszÄ… wartoÅ›ciÄ… w poszczegÃ³lne dni.


```{r}
i=1
Maxi=dgpw$Max
Mini=dgpw$Min
roznica=rep(0,250)
for(i in 1:250){
  roznica[i]=Maxi[i]-Mini[i]
}
plot(x,roznica, type="l", main="RÃ³Å¼nica pomiÄ™dzy najwiÄ™kszÄ… a najmniejszÄ… wartoÅ›ciÄ…", xlab="Dni robocze od 16.03.2018", ylab="WartoÅ›Ä‡")
```


Na koniec zobaczmy zestawienie wszystkich badanych wartoÅ›ci w postaci wykresu pudeÅ‚kowego.

```{r}
boxplot(dgpw$Otwarcie,dgpw$Zamkniecie,dgpw$Max,dgpw$Min, names=c("Otwarcie","Zamkniecie","Maksimum","Minimum"), col=rainbow(5))
```






PREDYKCJA


```{r}
dgpw2 <- read.csv("GPW-VividGamesSA-dane.csv", col.names =c("Data","Otwarcie","Zamkniecie","Max","Min","Obrot_mln_zl","Zmiana_proc."))
x=length(dgpw2$Data):1
 plot(x,dgpw2$Otwarcie,'p',col="red", xlab="Dni robocze", ylab="Cena otwarcia");
 reg <- lm(dgpw2$Otwarcie~x);
 abline(reg)
```
```{r}
summary(reg)
```
```{r}
blad_sredniokwad <- function(zbior, pred) 
    { n=length(pred)
    i=1
    suma=0
    blad=0
    for(i in 1:n){ 
      l=pred$fitted.values[i]
      blad[i]=(zbior[i]-l)^2
    suma=suma+blad[i]
      }
   return(suma/n)
    }

Statystyka_theila <- function(zbior, pred) 
    {
    
    n=length(pred)
    i=1
    sumalicz=0
    sumamian=0
    roz=0
    for(i in 1:n){ 
      l=pred$fitted.values[i]
      
      roz[i]=(zbior[i+1]-l)^2
    sumalicz=sumalicz+roz[i]
    sumamian=sumamian+l^2
      }
   iloraz=sumalicz/sumamian
   return(iloraz)
}



```




```{r}
dl=length(dgpw2$Otwarcie)
n0=1:dl
otwarcie=dgpw2$Otwarcie
model=lm(otwarcie~n0)

plot(predict(model),main="predykcja w oparciu o dane z ostatniego roku", xlab="dni", ylab="cena otwarcia")
```




B³¹d œredniokwadratowy dla modelu:
```{r}
blad_sredniokwad(dgpw$Otwarcie,model)
```


Statystyka Theil'a:
```{r}
Statystyka_theila(dgpw$Otwarcie,model)
```



```{r}
n=90
otwarcie2=dgpw2$Otwarcie[1:n]
x2=1:n
model90=lm(otwarcie2~x2)
plot(predict(model90),main="predykcja w oparciu o dane z ostatnich 90 dni", xlab="dni", ylab="cena otwarcia")
```




B³¹d œredniokwadratowy dla modelu:
```{r}
blad_sredniokwad(dgpw$Otwarcie,model90)
```


Statystyka Theil'a:
```{r}
Statystyka_theila(dgpw$Otwarcie,model90)
```


```{r}
n2=14
otwarcie3=dgpw2$Otwarcie[n2:1]
x2=1:n2
model14=lm(otwarcie3~x2)
plot(predict(model14),main="predykcja w oparciu o dane z ostatnich 14 dni", xlab="dni", ylab="cena otwarcia")
```



B³¹d œredniokwadratowy dla modelu:
```{r}
blad_sredniokwad(dgpw$Otwarcie,model14)
```


Statystyka Theil'a:
```{r}
Statystyka_theila(dgpw$Otwarcie,model14)
```


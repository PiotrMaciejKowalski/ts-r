---
title: "Zadanie4"
author: "Justyna KapuciĹ„ska"
date: "26 kwietnia 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Instaluje potrzebny pakiet i wczytuje dane
```{r}
library(dplyr)
dane=read.csv2("Kapucinska_WTI_USD.csv")
```

#Pierwszy proces filtrowania potokowego
WybiorÄ™ notowania ze stycznia, utworzÄ™ nowÄ… kolumnÄ™ (rĂłĹĽnice ceny zamkniÄ™cia i otwarcia) oraz wybiorÄ™ notowania dla ktĂłrych rĂłĹĽnica jest wiÄ™ksza od zera.
```{r}
dane %>%
  filter(grepl("sty", Data)) %>%
  mutate(rĂłĹĽnica=ZamkniÄ™cie.-Otwarcie.)%>%
  filter(rĂłĹĽnica>0)->dane1
head(dane1)
```

#Wykres
```{r}
plot(dane1$rĂłĹĽnica, type="o", main="Dodatnia rĂłĹĽnica cen w lutym", xlab = "Dni", ylab="RĂłĹĽnica")
```

#Drugi proces filtrowania potokowego
UtworzÄ™ nowÄ… kolumnÄ™ (Ĺ›redniÄ… wartoĹ›Ä‡ cen) i wybiorÄ™ ceny otwarcia mniejsze od Ĺ›redniej.
```{r}
dane %>%
  mutate(Ĺ›r_wartoĹ›Ä‡=(WartoĹ›Ä‡.najwyĹĽsza.+WartoĹ›Ä‡.najniĹĽsza.)/2)%>%
  filter(Ĺ›r_wartoĹ›Ä‡>Otwarcie.)->dane2
head(dane2)
```

#Wykres
```{r}
plot(dane2$Ĺ›r_wartoĹ›Ä‡, type="o", main="Ĺšrednia wartoĹ›Ä‡", xlab = "Dni", ylab="WartoĹ›Ä‡")
```

#Trzeci proces filtrowania potokowego
PogrupujÄ™ dane wedĹ‚ug godziny i wyĹ›wietlÄ™ Ĺ›rednie ceny.
```{r}
dane %>%
  group_by(Godzina.)%>%
  summarise(Ĺšr_otwarcie=mean(Otwarcie.), Ĺšr_wart_najwyĹĽsza=mean(WartoĹ›Ä‡.najwyĹĽsza.), Ĺšr_wart_najniĹĽsza=mean(WartoĹ›Ä‡.najniĹĽsza.), Ĺšr_zamkniÄ™cie=mean(ZamkniÄ™cie.))->dane3
dane3
```

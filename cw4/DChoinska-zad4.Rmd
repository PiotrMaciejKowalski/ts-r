---
title: "zadanie 4"
author: "Choińska Daria"
date: "30 kwietnia 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Wczytuję dane dotyczące kursu euro do dolara nowozelandzkiego, które pochodzą ze strony Histdata.com

```{r}
library(dplyr)
library(tidyr)
dane <- read.table(file = 'Choińska_Dane.csv',col.names =c('Data','Godzina','Kurs rozpoczęcia','Kurs zakończenia'), sep =";")
head(dane)
```
## Pierwsze filtrowanie potokowe
W pierwszym procesie zaprezentuję kursy z godziny 12:00 dla których kurs zamknięcia i rozpoczęcia jest przynajmniej równy ze średnim kursem rozpoczęcia 
```{r}
o <- mean(dane$Kurs.rozpoczęcia)
dane %>%
  filter(Godzina==120000, Kurs.rozpoczęcia >=o,Kurs.zakończenia>=o)%>%
  select(Godzina,Kurs.rozpoczęcia,Kurs.zakończenia)-> result
head (result)

```
```{r}
plot(result$Kurs.rozpoczęcia, xlab="Pomiar",ylab="Kurs.rozpoczęcia",main="Kursy większe niż średni kurs otwarcia z godziny 12:00")
```

##Drugie filtrowanie potokowe
W drugim procesie potokowym pokażę różnicę pomiędzy kursem rozpoczęcia a kursem zakończenia z godziny 20:00

```{r}
dane %>%
  filter(Godzina==200000) %>%
  select(Godzina,Kurs.rozpoczęcia,Kurs.zakończenia) %>%
  mutate(roznica=Kurs.zakończenia-Kurs.rozpoczęcia) -> dane2
```
```{r}
plot(dane2$roznica,xlab = "Pomiar",ylab = "roznica",main= "różnica pomiędzy kursem rozpoczęcia a kursem zakończenia z godziny 20:00")
```

##Trzecie filtrowanie potokowe

W trzecim procesie potokowym pogrupuję i podsumuję pewne dane
```{r}
dane %>%
  filter(Godzina==80000) %>%
  mutate(roznica=Kurs.zakończenia-Kurs.rozpoczęcia) %>%
  arrange(Kurs.rozpoczęcia) %>%
  group_by(Kurs.rozpoczęcia) %>%
  summarise(srednia=mean(roznica, na.rm = TRUE)) -> dane3
head(dane3)
```
```{r}
matplot(dane3$Kurs.rozpoczęcia, dane3$srednia, xlab="Zmiana", ylab="średnie wartości", "l", col="blue")
```









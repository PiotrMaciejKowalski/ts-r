---
title: "zadanie 4"
author: "ChoiÅ„ska Daria"
date: "30 kwietnia 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#WczytujÄ™ dane dotyczÄ…ce kursu euro do dolara nowozelandzkiego, które pochodz¹ ze strony Histdata.com

```{r}
library(dplyr)
library(tidyr)
dane <- read.table(file = 'Choiñska_Dane.csv',col.names =c('Data','Godzina','Kurs rozpoczêcia','Kurs zakoñczenia'), sep =";")
head(dane)
```
## Pierwsze filtrowanie potokowe
W pierwszym procesie zaprezentujê kursy z godziny 12:00 dla których kurs zamkniêcia i rozpoczecia jest przynajmniej równy ze œrednim kursem rozpoczêcia 
```{r}
o <- mean(dane$Kurs.rozpoczêcia)
dane %>%
  filter(Godzina==120000, Kurs.rozpoczêcia >=o,Kurs.zakoñczenia>=o)%>%
  select(Godzina,Kurs.rozpoczêcia,Kurs.zakoñczenia)-> result
head (result)

```
```{r}
plot(result$Kurs.rozpoczêcia, xlab="Pomiar",ylab="Kurs.rozpoczêcia",main="Kursy wiêksze ni¿ œredni kurs otwarcia z godziny 12:00")
```

##Drugie filtrowanie potokowe
W drugim procesie potokowym poka¿ê ró¿nicê pomiêdzy kursem rozpoczêcia a kursem zakoñczenia z godziny 20:00

```{r}
dane %>%
  filter(Godzina==200000) %>%
  select(Godzina,Kurs.rozpoczêcia,Kurs.zakoñczenia) %>%
  mutate(roznica=Kurs.zakoñczenia-Kurs.rozpoczêcia) -> dane2
```
```{r}
plot(dane2$roznica,xlab = "Pomiar",ylab = "roznica",main= "roznica pomiedzy kursem rozpoczêcia a kursem zakoñczenia z godziny 20:00")
```

##Trzecie filtrowanie potokowe

W trzecim procesie potokowym pogrupujê i podsumujê pewne dane
```{r}
dane %>%
  filter(Godzina==80000) %>%
  mutate(roznica=Kurs.zakoñczenia-Kurs.rozpoczêcia) %>%
  arrange(Kurs.rozpoczêcia) %>%
  group_by(Kurs.rozpoczêcia) %>%
  summarise(srednia=mean(roznica, na.rm = TRUE)) -> dane3
head(dane3)
```
```{r}
matplot(dane3$Kurs.rozpoczêcia, dane3$srednia, xlab="Zmiana", ylab="Å›rednie wartoÅ›ci", "l", col="blue")
```








